#include <stdio.h>
#include <fcntl.h>
#include <stdlib.h>
#include <sys/types.h>
#include <dirent.h>
#include <string.h>


char* readFile(char *path)
{

	char c;
	char* buffer;
	FILE *file;
	file = fopen(path, "r");
	if (file) 
	{
    	while ((c = getc(file)) != EOF)
    		strncat(buffer, &c, 1);
	}
	fclose(file);
	return buffer;

}


void encrypt(char* path)
{

	char* buffer = readFile(path);
	//printf("%s", buffer);

	// for(int i = 0; i < strlen(buffer);i ++)
	// {
	// 	buffer[i] ^= 20;
	// }
	// printf("%s", buffer);
	//printf("%c", buffer[1]);

	return buffer;
}



void findFile(char* path)
{
	DIR *dir;
	struct dirent *entry;

	if((dir = opendir(path)) == NULL)
		perror("opendir() error");
	
	else
	{
		while((entry = readdir(dir)) != NULL)
		{
			if(strcmp(entry->d_name, ".") != 0 && strcmp(entry->d_name, "..") != 0)
			{
				if(entry->d_type == DT_DIR)
				{
					char tmppath[2048];
					strcpy(tmppath, path);
					strcat(tmppath, "/");
					strcat(tmppath, entry->d_name);
					findFile(tmppath);	
				}
				else
				{
					char tmppath2[2048];
					sprintf(tmppath2, "%s/%s", path, entry->d_name);
					printf("%s\n", tmppath2);
				}
			}


		}
	}

}


int main()
{
	//findFile("/home/nha/Desktop");
	//puts(readFile("/home/nha/Downloads/SysProc5/linux_process.c"));
		encrypt("/home/nha/Downloads/SysProc5/linux_process.c");

	return 0;
}